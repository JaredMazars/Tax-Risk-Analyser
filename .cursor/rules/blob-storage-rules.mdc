---
description: for blob storage services
alwaysApply: false
---
# Blob Storage Container Convention

## When To Apply This Rule

- Uploading files to Azure Blob Storage
- Creating new document storage features
- Working with engagement letters, DPAs, or acceptance documents
- Implementing file upload/download functionality
- Designing storage architecture for new document types
- Reviewing blob storage code for compliance

## RULE: Purpose-Specific Containers

**All blob storage operations MUST use purpose-specific containers. Never store different document types in the same container.**

### Container Naming
- Format: `{purpose}` or `{purpose}-{category}`
- Examples: `engagement-letters`, `acceptance-documents`, `dpa`
- Use lowercase with hyphens for multi-word names

### Path Structure
Within each container: `{entityId}/{timestamp}_{sanitized_filename}`

### Current Containers
| Container | Purpose | Path Pattern |
|-----------|---------|--------------|
| `engagement-letters` | Engagement letter documents | `{taskId}/{timestamp}_{filename}` |
| `dpa` | Data Processing Agreements | `{taskId}/{timestamp}_{filename}` |
| `acceptance-documents` | A&C (Acceptance & Continuance) documents | `{taskId}/{timestamp}_{filename}` |
| `review-notes` | Review note attachments | `{noteId}/{timestamp}_{filename}` |
| `news-bulletins` | News bulletin documents | `{bulletinId}/{timestamp}_{filename}` |

### Implementation Requirements

For each new document type, create:
1. Container name constant
2. Container client function
3. Initialization function  
4. Upload/download functions using the dedicated container

### Benefits
- Clear separation of document types
- Better access control via container-level permissions
- Easier lifecycle management per type
- Simpler paths without redundant prefixes
- Independent scaling per container

### Code Review Checklist
- New blob storage code uses dedicated container
- Container name reflects document purpose
- Container initialization function exists
- Upload/download functions use correct container client
- No mixing of document types in same container

## Related Rules

- **ai-patterns.mdc**: Document Intelligence for extracting structured data from uploaded documents
- **approval-system-rules.mdc**: Approval workflows for documents requiring review (engagement letters, DPAs)
- **security-rules.mdc**: File upload security, MIME type validation, access control for blob storage
- **consolidated.mdc**: Error handling, logging, and data protection requirements for file operations
